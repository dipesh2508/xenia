{"version":3,"sources":["../src/utils/prisma.ts","../src/utils/generateToken.ts","../src/controllers/user.controller.ts","../src/middleware/isUserLoggedIn.ts","../src/routes/user.route.ts","../src/utils/cloudinary.ts","../src/controllers/community.controller.ts","../src/routes/community.route.ts","../src/app.ts","../src/index.ts"],"names":["PrismaClient","jwt","bcrypt","express","cloudinary","CloudinaryStorage","multer","router","dotenv","path","cookieParser","cors"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAEA,IAAM,MAAA,GAAS,IAAIA,mBAAa,EAAA;ACQzB,IAAM,gBAAA,GAAmB,CAAC,MAAA,EAAoB,GAA2B,KAAA;AAC9E,EAAM,MAAA,KAAA,GAAQC,qBAAI,IAAK,CAAA,EAAE,IAAI,MAAO,EAAA,EAAG,OAAQ,CAAA,GAAA,CAAI,UAAa,EAAA;AAAA,IAC9D,SAAW,EAAA;AAAA,GACZ,CAAA;AAED,EAAA,IAAI,GAAK,EAAA;AACP,IAAI,GAAA,CAAA,MAAA,CAAO,SAAS,KAAO,EAAA;AAAA,MACzB,QAAU,EAAA,IAAA;AAAA,MACV,MAAA,EAAQ,OAAQ,CAAA,GAAA,CAAI,QAAa,KAAA,YAAA;AAAA,MACjC,QAAU,EAAA,QAAA;AAAA,MACV,MAAQ,EAAA,EAAA,GAAK,EAAK,GAAA,EAAA,GAAK,EAAK,GAAA;AAAA;AAAA,KAC7B,CAAA;AAAA;AAGH,EAAO,OAAA,KAAA;AACT,CAAA;;;ACpBO,IAAM,UAAA,GAAa,OAAO,GAAA,EAAc,GAAiC,KAAA;AAC9E,EAAA,MAAM,EAAE,IAAA,EAAM,KAAO,EAAA,QAAA,KAAa,GAAI,CAAA,IAAA;AAEtC,EAAI,IAAA;AACF,IAAA,IAAI,CAAC,IAAA,IAAQ,CAAC,KAAA,IAAS,CAAC,QAAU,EAAA;AAChC,MAAI,GAAA,CAAA,MAAA,CAAO,GAAG,CAAA,CAAE,IAAK,CAAA;AAAA,QACnB,OAAS,EAAA;AAAA,OACV,CAAA;AACD,MAAA;AAAA;AAGF,IAAI,IAAA,QAAA,EAAU,SAAS,CAAG,EAAA;AACxB,MAAI,GAAA,CAAA,MAAA,CAAO,GAAG,CAAA,CAAE,IAAK,CAAA;AAAA,QACnB,OAAS,EAAA;AAAA,OACV,CAAA;AACD,MAAA;AAAA;AAIF,IAAA,MAAM,YAAe,GAAA,MAAM,MAAO,CAAA,IAAA,CAAK,UAAW,CAAA;AAAA,MAChD,KAAA,EAAO,EAAE,KAAM;AAAA,KAChB,CAAA;AAED,IAAA,IAAI,YAAc,EAAA;AAChB,MAAI,GAAA,CAAA,MAAA,CAAO,GAAG,CAAA,CAAE,IAAK,CAAA;AAAA,QACnB,OAAS,EAAA;AAAA,OACV,CAAA;AACD,MAAA;AAAA;AAGF,IAAA,MAAM,IAAO,GAAA,MAAMC,uBAAO,CAAA,OAAA,CAAQ,EAAE,CAAA;AACpC,IAAA,MAAM,cAAiB,GAAA,MAAMA,uBAAO,CAAA,IAAA,CAAK,UAAU,IAAI,CAAA;AAEvD,IAAA,MAAM,OAAU,GAAA,MAAM,MAAO,CAAA,IAAA,CAAK,MAAO,CAAA;AAAA,MACvC,IAAM,EAAA;AAAA,QACJ,IAAA;AAAA,QACA,KAAA;AAAA,QACA,QAAU,EAAA;AAAA,OACZ;AAAA,MACA,MAAQ,EAAA;AAAA,QACN,EAAI,EAAA,IAAA;AAAA,QACJ,IAAM,EAAA,IAAA;AAAA,QACN,KAAO,EAAA;AAAA;AACT,KACD,CAAA;AAGD,IAAiB,gBAAA,CAAA,OAAA,CAAQ,IAAI,GAAG,CAAA;AAGhC,IAAA,GAAA,CAAI,MAAO,CAAA,GAAG,CAAE,CAAA,IAAA,CAAK,OAAO,CAAA;AAAA,WACrB,KAAO,EAAA;AACd,IAAQ,OAAA,CAAA,KAAA,CAAM,iBAAiB,KAAK,CAAA;AACpC,IAAI,GAAA,CAAA,MAAA,CAAO,GAAG,CAAA,CAAE,IAAK,CAAA;AAAA,MACnB,OAAS,EAAA;AAAA,KACV,CAAA;AAAA;AAEL,CAAA;AAEO,IAAM,SAAA,GAAY,OAAO,GAAA,EAAc,GAAiC,KAAA;AAC7E,EAAA,MAAM,EAAE,KAAA,EAAO,QAAS,EAAA,GAAI,GAAI,CAAA,IAAA;AAEhC,EAAI,IAAA;AACF,IAAI,IAAA,CAAC,KAAS,IAAA,CAAC,QAAU,EAAA;AACvB,MAAI,GAAA,CAAA,MAAA,CAAO,GAAG,CAAA,CAAE,IAAK,CAAA;AAAA,QACnB,OAAS,EAAA;AAAA,OACV,CAAA;AACD,MAAA;AAAA;AAGF,IAAA,MAAM,IAAO,GAAA,MAAM,MAAO,CAAA,IAAA,CAAK,UAAW,CAAA;AAAA,MACxC,KAAA,EAAO,EAAE,KAAM,EAAA;AAAA,MACf,MAAQ,EAAA;AAAA,QACN,EAAI,EAAA,IAAA;AAAA,QACJ,KAAO,EAAA,IAAA;AAAA,QACP,IAAM,EAAA,IAAA;AAAA,QACN,QAAU,EAAA;AAAA;AACZ,KACD,CAAA;AAED,IAAA,IAAI,CAAC,IAAA,IAAQ,CAAC,IAAA,CAAK,QAAU,EAAA;AAC3B,MAAI,GAAA,CAAA,MAAA,CAAO,GAAG,CAAA,CAAE,IAAK,CAAA;AAAA,QACnB,OAAS,EAAA;AAAA,OACV,CAAA;AACD,MAAA;AAAA;AAGF,IAAA,MAAM,UAAU,MAAMA,uBAAA,CAAO,OAAQ,CAAA,QAAA,EAAU,KAAK,QAAQ,CAAA;AAE5D,IAAA,IAAI,CAAC,OAAS,EAAA;AACZ,MAAI,GAAA,CAAA,MAAA,CAAO,GAAG,CAAA,CAAE,IAAK,CAAA;AAAA,QACnB,OAAS,EAAA;AAAA,OACV,CAAA;AACD,MAAA;AAAA;AAIF,IAAiB,gBAAA,CAAA,IAAA,CAAK,IAAI,GAAG,CAAA;AAG7B,IAAI,GAAA,CAAA,MAAA,CAAO,GAAG,CAAA,CAAE,IAAK,CAAA;AAAA,MACnB,IAAI,IAAK,CAAA,EAAA;AAAA,MACT,MAAM,IAAK,CAAA,IAAA;AAAA,MACX,OAAO,IAAK,CAAA;AAAA,KACb,CAAA;AAAA,WACM,KAAO,EAAA;AACd,IAAQ,OAAA,CAAA,KAAA,CAAM,gBAAgB,KAAK,CAAA;AACnC,IAAI,GAAA,CAAA,MAAA,CAAO,GAAG,CAAA,CAAE,IAAK,CAAA;AAAA,MACnB,OAAS,EAAA;AAAA,KACV,CAAA;AAAA;AAEL,CAAA;AAEO,IAAM,MAAA,GAAS,OAAO,GAAA,EAAc,GAAiC,KAAA;AAC1E,EAAI,IAAA;AACF,IAAA,GAAA,CAAI,YAAY,OAAO,CAAA;AACvB,IAAI,GAAA,CAAA,MAAA,CAAO,GAAG,CAAA,CAAE,IAAK,CAAA;AAAA,MACnB,OAAS,EAAA;AAAA,KACV,CAAA;AAAA,WACM,KAAO,EAAA;AACd,IAAQ,OAAA,CAAA,KAAA,CAAM,iBAAiB,KAAK,CAAA;AACpC,IAAI,GAAA,CAAA,MAAA,CAAO,GAAG,CAAA,CAAE,IAAK,CAAA;AAAA,MACnB,OAAS,EAAA;AAAA,KACV,CAAA;AAAA;AAEL,CAAA;AAEO,IAAM,SAAA,GAAY,OAAO,GAAA,EAAU,GAAiC,KAAA;AACzE,EAAI,IAAA;AACF,IAAA,GAAA,CAAI,MAAO,CAAA,GAAG,CAAE,CAAA,IAAA,CAAK,IAAI,IAAI,CAAA;AAAA,WACtB,KAAO,EAAA;AACd,IAAQ,OAAA,CAAA,KAAA,CAAM,oBAAoB,KAAK,CAAA;AACvC,IAAI,GAAA,CAAA,MAAA,CAAO,GAAG,CAAA,CAAE,IAAK,CAAA;AAAA,MACnB,OAAS,EAAA;AAAA,KACV,CAAA;AAAA;AAEL,CAAA;AAEO,IAAM,UAAA,GAAa,OAAO,GAAA,EAAc,GAAiC,KAAA;AAC9E,EAAM,MAAA,MAAA,GAAS,IAAI,MAAO,CAAA,EAAA;AAE1B,EAAI,IAAA;AACF,IAAA,MAAM,WAAc,GAAA,MAAM,MAAO,CAAA,IAAA,CAAK,MAAO,CAAA;AAAA,MAC3C,KAAO,EAAA;AAAA,QACL,EAAI,EAAA;AAAA;AACN,KACD,CAAA;AAED,IAAA,IAAI,CAAC,WAAa,EAAA;AAChB,MAAI,GAAA,CAAA,MAAA,CAAO,GAAG,CAAA,CAAE,IAAK,CAAA;AAAA,QACnB,OAAS,EAAA;AAAA,OACV,CAAA;AACD,MAAA;AAAA;AAGF,IAAI,GAAA,CAAA,MAAA,CAAO,GAAG,CAAA,CAAE,IAAK,CAAA;AAAA,MACnB,OAAS,EAAA;AAAA,KACV,CAAA;AAAA,WACM,KAAO,EAAA;AACd,IAAQ,OAAA,CAAA,KAAA,CAAM,sBAAsB,KAAK,CAAA;AACzC,IAAI,GAAA,CAAA,MAAA,CAAO,GAAG,CAAA,CAAE,IAAK,CAAA;AAAA,MACnB,OAAS,EAAA;AAAA,KACV,CAAA;AAAA;AAEL,CAAA;ACpKO,IAAM,UAAa,GAAA,OACxB,GACA,EAAA,GAAA,EACA,IACiB,KAAA;AACjB,EAAM,MAAA,KAAA,GAAQ,IAAI,OAAQ,CAAA,KAAA;AAE1B,EAAA,IAAI,CAAC,KAAO,EAAA;AACV,IAAA,OAAO,GAAI,CAAA,MAAA,CAAO,GAAG,CAAA,CAAE,IAAK,CAAA;AAAA,MAC1B,OAAS,EAAA;AAAA,KACV,CAAA;AAAA;AAGH,EAAI,IAAA;AACF,IAAI,IAAA,CAAC,OAAQ,CAAA,GAAA,CAAI,UAAY,EAAA;AAC3B,MAAM,MAAA,IAAI,MAAM,2BAA2B,CAAA;AAAA;AAG7C,IAAA,MAAM,UAAUD,oBAAI,CAAA,MAAA,CAAO,KAAO,EAAA,OAAA,CAAQ,IAAI,UAAU,CAAA;AAIxD,IAAI,IAAA,CAAC,QAAQ,MAAQ,EAAA;AACnB,MAAA,OAAO,GAAI,CAAA,MAAA,CAAO,GAAG,CAAA,CAAE,IAAK,CAAA;AAAA,QAC1B,OAAS,EAAA;AAAA,OACV,CAAA;AAAA;AAGH,IAAA,MAAM,IAAO,GAAA,MAAM,MAAO,CAAA,IAAA,CAAK,UAAW,CAAA;AAAA,MACxC,KAAO,EAAA;AAAA,QACL,IAAI,OAAQ,CAAA;AAAA,OACd;AAAA,MACA,MAAQ,EAAA;AAAA,QACN,EAAI,EAAA,IAAA;AAAA,QACJ,IAAM,EAAA,IAAA;AAAA,QACN,KAAO,EAAA,IAAA;AAAA,QACP,KAAO,EAAA;AAAA;AACT,KACD,CAAA;AAED,IAAA,IAAI,CAAC,IAAM,EAAA;AACT,MAAA,OAAO,GAAI,CAAA,MAAA,CAAO,GAAG,CAAA,CAAE,IAAK,CAAA;AAAA,QAC1B,OAAS,EAAA;AAAA,OACV,CAAA;AAAA;AAGH,IAAA,GAAA,CAAI,IAAO,GAAA,IAAA;AACX,IAAK,IAAA,EAAA;AAAA,WACE,KAAO,EAAA;AACd,IAAQ,OAAA,CAAA,KAAA,CAAM,yBAAyB,KAAK,CAAA;AAC5C,IAAA,OAAO,GAAI,CAAA,MAAA,CAAO,GAAG,CAAA,CAAE,IAAK,CAAA;AAAA,MAC1B,OAAS,EAAA;AAAA,KACV,CAAA;AAAA;AAEL,CAAA;;;ACjDA,IAAM,MAAA,GAASE,0BAAQ,MAAO,EAAA;AAE9B,MAAA,CAAO,KAAM,CAAA,SAAS,CAAE,CAAA,IAAA,CAAK,UAAU,CAAA;AACvC,MAAA,CAAO,KAAM,CAAA,QAAQ,CAAE,CAAA,IAAA,CAAK,SAAS,CAAA;AACrC,MAAA,CAAO,KAAM,CAAA,SAAS,CAAE,CAAA,IAAA,CAAK,MAAM,CAAA;AACnC,MAAA,CAAO,KAAM,CAAA,YAAY,CAAE,CAAA,IAAA,CAAK,YAAY,SAAS,CAAA;AACrD,MAAA,CAAO,KAAM,CAAA,MAAM,CAAE,CAAA,MAAA,CAAO,YAAY,UAAU,CAAA;AAElD,IAAO,kBAAQ,GAAA,MAAA;ACdfC,aAAA,CAAW,MAAO,CAAA;AAAA,EAChB,UAAA,EAAY,QAAQ,GAAI,CAAA,qBAAA;AAAA,EACxB,OAAA,EAAS,QAAQ,GAAI,CAAA,kBAAA;AAAA,EACrB,UAAA,EAAY,QAAQ,GAAI,CAAA;AAC1B,CAAC,CAAA;AAED,IAAM,OAAA,GAAU,IAAIC,yCAAkB,CAAA;AAAA,cACpCD,aAAA;AAAA,EACA,MAAQ,EAAA;AAAA,IACN,MAAQ,EAAA,mBAAA;AAAA,IACR,eAAiB,EAAA,CAAC,KAAO,EAAA,MAAA,EAAQ,OAAO,KAAK,CAAA;AAAA,IAC7C,cAAA,EAAgB,CAAC,EAAE,KAAA,EAAO,KAAK,MAAQ,EAAA,GAAA,EAAK,IAAM,EAAA,OAAA,EAAS;AAAA;AAE/D,CAAC,CAAA;AAED,IAAM,mBAAmBE,uBAAO,CAAA;AAAA,EAC9B,OAAA;AAAA,EACA,MAAQ,EAAA;AAAA,IACN,QAAA,EAAU,IAAI,IAAO,GAAA;AAAA;AAAA;AAEzB,CAAC,CAAA;AAGM,IAAM,MAAS,GAAA;AAAA,EACpB,GAAG,gBAAA;AAAA,EACH,UAAU,OAAO;AAAA,IACf,GAAG,gBAAA;AAAA,IACH,QAAQ,CAAC,SAAA,KAAsB,CAAC,GAAA,EAAU,KAAU,IAAc,KAAA;AAChE,MAAA,IAAI,CAAC,GAAA,CAAI,KAAS,IAAA,CAAC,IAAI,IAAM,EAAA;AAC3B,QAAA,OAAO,IAAK,EAAA;AAAA;AAEd,MAAA,OAAO,iBAAiB,MAAO,CAAA,SAAS,CAAE,CAAA,GAAA,EAAK,KAAK,IAAI,CAAA;AAAA;AAC1D,GACF;AACF,CAAA;AAEO,IAAM,WAAA,GAAc,OAAO,QAAqB,KAAA;AACrD,EAAI,IAAA;AACF,IAAM,MAAAF,aAAA,CAAW,QAAS,CAAA,OAAA,CAAQ,QAAQ,CAAA;AAAA,WACnC,KAAO,EAAA;AACd,IAAQ,OAAA,CAAA,KAAA,CAAM,yCAAyC,KAAK,CAAA;AAAA;AAEhE,CAAA;AAEO,IAAM,kBAAA,GAAqB,CAAC,GAAgB,KAAA;AACjD,EAAM,MAAA,MAAA,GAAS,GAAI,CAAA,KAAA,CAAM,GAAG,CAAA;AAC5B,EAAA,MAAM,QAAW,GAAA,MAAA,CAAO,MAAO,CAAA,MAAA,GAAS,CAAC,CAAK,IAAA,EAAA;AAC9C,EAAA,OAAO,qBAAqB,QAAS,CAAA,KAAA,CAAM,GAAG,CAAA,CAAE,CAAC,CAAC,CAAA,CAAA;AACpD,CAAA;;;AChDO,IAAM,eAAA,GAAkB,OAAO,GAAA,EAAU,GAAiC,KAAA;AAC/E,EAAI,IAAA;AACF,IAAA,MAAM,EAAE,IAAA,EAAM,WAAY,EAAA,GAAI,GAAI,CAAA,IAAA;AAClC,IAAM,MAAA,MAAA,GAAS,IAAI,IAAK,CAAA,EAAA;AAExB,IAAA,IAAI,CAAC,IAAM,EAAA;AACT,MAAA,GAAA,CAAI,OAAO,GAAG,CAAA,CAAE,KAAK,EAAE,OAAA,EAAS,8BAA8B,CAAA;AAC9D,MAAA;AAAA;AAGF,IAAI,IAAA,IAAA,CAAK,SAAS,GAAK,EAAA;AACrB,MAAA,GAAA,CAAI,OAAO,GAAG,CAAA,CAAE,KAAK,EAAE,OAAA,EAAS,mDAAmD,CAAA;AACnF,MAAA;AAAA;AAIF,IAAA,MAAM,iBAAoB,GAAA,MAAM,MAAO,CAAA,SAAA,CAAU,SAAU,CAAA;AAAA,MACzD,KAAA,EAAO,EAAE,IAAK;AAAA,KACf,CAAA;AAED,IAAA,IAAI,iBAAmB,EAAA;AACrB,MAAA,GAAA,CAAI,OAAO,GAAG,CAAA,CAAE,KAAK,EAAE,OAAA,EAAS,iCAAiC,CAAA;AACjE,MAAA;AAAA;AAGF,IAAA,MAAM,SAAY,GAAA,MAAM,MAAO,CAAA,SAAA,CAAU,MAAO,CAAA;AAAA,MAC9C,IAAM,EAAA;AAAA,QACJ,IAAA;AAAA,QACA,WAAA;AAAA,QACA,GAAI,IAAI,IAAM,EAAA,IAAA,IAAQ,EAAE,KAAO,EAAA,GAAA,CAAI,KAAK,IAAK,EAAA;AAAA,QAC7C,OAAS,EAAA,MAAA;AAAA,QACT,OAAS,EAAA;AAAA,UACP,MAAQ,EAAA;AAAA,YACN,MAAA;AAAA,YACA,IAAM,EAAA;AAAA;AACR;AACF;AACF,KACD,CAAA;AAED,IAAA,GAAA,CAAI,MAAO,CAAA,GAAG,CAAE,CAAA,IAAA,CAAK,SAAS,CAAA;AAAA,WACvB,KAAO,EAAA;AACd,IAAQ,OAAA,CAAA,KAAA,CAAM,2BAA2B,KAAK,CAAA;AAC9C,IAAA,GAAA,CAAI,OAAO,GAAG,CAAA,CAAE,KAAK,EAAE,OAAA,EAAS,yBAAyB,CAAA;AAAA;AAE7D,CAAA;AAEO,IAAM,YAAA,GAAe,OAAO,GAAA,EAAc,GAAiC,KAAA;AAChF,EAAI,IAAA;AACF,IAAM,MAAA,EAAE,EAAG,EAAA,GAAI,GAAI,CAAA,MAAA;AAEnB,IAAA,MAAM,SAAY,GAAA,MAAM,MAAO,CAAA,SAAA,CAAU,UAAW,CAAA;AAAA,MAClD,KAAA,EAAO,EAAE,EAAG,EAAA;AAAA,MACZ,OAAS,EAAA;AAAA,QACP,KAAO,EAAA;AAAA,UACL,MAAQ,EAAA;AAAA,YACN,EAAI,EAAA,IAAA;AAAA,YACJ,IAAM,EAAA,IAAA;AAAA,YACN,KAAO,EAAA,IAAA;AAAA,YACP,KAAO,EAAA;AAAA;AACT;AACF;AACF,KACD,CAAA;AAED,IAAA,IAAI,CAAC,SAAW,EAAA;AACd,MAAA,GAAA,CAAI,OAAO,GAAG,CAAA,CAAE,KAAK,EAAE,OAAA,EAAS,uBAAuB,CAAA;AACvD,MAAA;AAAA;AAGF,IAAA,GAAA,CAAI,MAAO,CAAA,GAAG,CAAE,CAAA,IAAA,CAAK,SAAS,CAAA;AAAA,WACvB,KAAO,EAAA;AACd,IAAQ,OAAA,CAAA,KAAA,CAAM,wBAAwB,KAAK,CAAA;AAC3C,IAAA,GAAA,CAAI,OAAO,GAAG,CAAA,CAAE,KAAK,EAAE,OAAA,EAAS,yBAAyB,CAAA;AAAA;AAE7D,CAAA;AAEO,IAAM,iBAAA,GAAoB,OAAO,GAAA,EAAc,GAAiC,KAAA;AACrF,EAAI,IAAA;AACF,IAAA,MAAM,IAAO,GAAA,QAAA,CAAS,GAAI,CAAA,KAAA,CAAM,IAAc,CAAK,IAAA,CAAA;AACnD,IAAA,MAAM,KAAQ,GAAA,QAAA,CAAS,GAAI,CAAA,KAAA,CAAM,KAAe,CAAK,IAAA,EAAA;AACrD,IAAM,MAAA,MAAA,GAAS,IAAI,KAAM,CAAA,MAAA;AACzB,IAAM,MAAA,IAAA,GAAA,CAAQ,OAAO,CAAK,IAAA,KAAA;AAE1B,IAAA,MAAM,QAAQ,MAAS,GAAA;AAAA,MACrB,IAAM,EAAA;AAAA,QACJ,QAAU,EAAA,MAAA;AAAA,QACV,IAAM,EAAA;AAAA;AACR,QACE,EAAC;AAEL,IAAI,IAAA,GAAA,CAAI,MAAM,IAAQ,IAAA,GAAA,CAAI,MAAM,KAAS,IAAA,GAAA,CAAI,MAAM,MAAQ,EAAA;AAEzD,MAAA,MAAM,CAAC,WAAa,EAAA,KAAK,CAAI,GAAA,MAAM,QAAQ,GAAI,CAAA;AAAA,QAC7C,MAAA,CAAO,UAAU,QAAS,CAAA;AAAA,UACxB,KAAA;AAAA,UACA,IAAA;AAAA,UACA,IAAM,EAAA,KAAA;AAAA,UACN,OAAS,EAAA;AAAA,YACP,KAAO,EAAA;AAAA,cACL,MAAQ,EAAA;AAAA,gBACN,EAAI,EAAA,IAAA;AAAA,gBACJ,IAAM,EAAA,IAAA;AAAA,gBACN,KAAO,EAAA;AAAA;AACT,aACF;AAAA,YACA,MAAQ,EAAA;AAAA,cACN,MAAQ,EAAA;AAAA,gBACN,OAAS,EAAA;AAAA;AACX;AACF;AACF,SACD,CAAA;AAAA,QACD,MAAO,CAAA,SAAA,CAAU,KAAM,CAAA,EAAE,OAAO;AAAA,OACjC,CAAA;AAED,MAAI,GAAA,CAAA,MAAA,CAAO,GAAG,CAAA,CAAE,IAAK,CAAA;AAAA,QACnB,WAAA;AAAA,QACA,KAAA;AAAA,QACA,OAAA,EAAS,QAAQ,IAAO,GAAA;AAAA,OACzB,CAAA;AAAA,KACI,MAAA;AAEL,MAAA,MAAM,WAAc,GAAA,MAAM,MAAO,CAAA,SAAA,CAAU,QAAS,CAAA;AAAA,QAClD,OAAS,EAAA;AAAA,UACP,KAAO,EAAA;AAAA,YACL,MAAQ,EAAA;AAAA,cACN,EAAI,EAAA,IAAA;AAAA,cACJ,IAAM,EAAA,IAAA;AAAA,cACN,KAAO,EAAA;AAAA;AACT,WACF;AAAA,UACA,MAAQ,EAAA;AAAA,YACN,MAAQ,EAAA;AAAA,cACN,OAAS,EAAA;AAAA;AACX;AACF;AACF,OACD,CAAA;AAED,MAAA,GAAA,CAAI,MAAO,CAAA,GAAG,CAAE,CAAA,IAAA,CAAK,WAAW,CAAA;AAAA;AAClC,WACO,KAAO,EAAA;AACd,IAAQ,OAAA,CAAA,KAAA,CAAM,8BAA8B,KAAK,CAAA;AACjD,IAAA,GAAA,CAAI,OAAO,GAAG,CAAA,CAAE,KAAK,EAAE,OAAA,EAAS,yBAAyB,CAAA;AAAA;AAE7D,CAAA;AAEO,IAAM,eAAA,GAAkB,OAAO,GAAA,EAAU,GAAiC,KAAA;AAC/E,EAAI,IAAA;AACF,IAAM,MAAA,EAAE,EAAG,EAAA,GAAI,GAAI,CAAA,MAAA;AACnB,IAAA,MAAM,EAAE,IAAA,EAAM,WAAY,EAAA,GAAI,GAAI,CAAA,IAAA;AAClC,IAAM,MAAA,MAAA,GAAS,IAAI,IAAK,CAAA,EAAA;AAExB,IAAA,MAAM,SAAY,GAAA,MAAM,MAAO,CAAA,SAAA,CAAU,UAAW,CAAA;AAAA,MAClD,KAAA,EAAO,EAAE,EAAG;AAAA,KACb,CAAA;AAED,IAAA,IAAI,CAAC,SAAW,EAAA;AACd,MAAA,GAAA,CAAI,OAAO,GAAG,CAAA,CAAE,KAAK,EAAE,OAAA,EAAS,uBAAuB,CAAA;AACvD,MAAA;AAAA;AAGF,IAAI,IAAA,SAAA,CAAU,YAAY,MAAQ,EAAA;AAChC,MAAA,GAAA,CAAI,OAAO,GAAG,CAAA,CAAE,KAAK,EAAE,OAAA,EAAS,2CAA2C,CAAA;AAC3E,MAAA;AAAA;AAGF,IAAA,IAAI,IAAM,EAAA;AACR,MAAA,MAAM,iBAAoB,GAAA,MAAM,MAAO,CAAA,SAAA,CAAU,SAAU,CAAA;AAAA,QACzD,KAAO,EAAA;AAAA,UACL,IAAA;AAAA,UACA,EAAA,EAAI,EAAE,GAAA,EAAK,EAAG;AAAA;AAChB,OACD,CAAA;AAED,MAAA,IAAI,iBAAmB,EAAA;AACrB,QAAA,GAAA,CAAI,OAAO,GAAG,CAAA,CAAE,KAAK,EAAE,OAAA,EAAS,iCAAiC,CAAA;AACjE,QAAA;AAAA;AACF;AAIF,IAAA,IAAI,GAAI,CAAA,IAAA,EAAM,IAAQ,IAAA,SAAA,CAAU,KAAO,EAAA;AACrC,MAAM,MAAA,QAAA,GAAW,kBAAmB,CAAA,SAAA,CAAU,KAAK,CAAA;AACnD,MAAA,MAAM,YAAY,QAAQ,CAAA;AAAA;AAG5B,IAAA,MAAM,gBAAmB,GAAA,MAAM,MAAO,CAAA,SAAA,CAAU,MAAO,CAAA;AAAA,MACrD,KAAA,EAAO,EAAE,EAAG,EAAA;AAAA,MACZ,IAAM,EAAA;AAAA,QACJ,IAAA;AAAA,QACA,WAAA;AAAA,QACA,GAAI,IAAI,IAAM,EAAA,IAAA,IAAQ,EAAE,KAAO,EAAA,GAAA,CAAI,KAAK,IAAK;AAAA;AAC/C,KACD,CAAA;AAED,IAAA,GAAA,CAAI,MAAO,CAAA,GAAG,CAAE,CAAA,IAAA,CAAK,gBAAgB,CAAA;AAAA,WAC9B,KAAO,EAAA;AACd,IAAQ,OAAA,CAAA,KAAA,CAAM,2BAA2B,KAAK,CAAA;AAC9C,IAAA,GAAA,CAAI,OAAO,GAAG,CAAA,CAAE,KAAK,EAAE,OAAA,EAAS,yBAAyB,CAAA;AAAA;AAE7D,CAAA;AAEO,IAAM,eAAA,GAAkB,OAAO,GAAA,EAAU,GAAiC,KAAA;AAC/E,EAAI,IAAA;AACF,IAAM,MAAA,EAAE,EAAG,EAAA,GAAI,GAAI,CAAA,MAAA;AACnB,IAAM,MAAA,MAAA,GAAS,IAAI,IAAK,CAAA,EAAA;AAExB,IAAA,MAAM,SAAY,GAAA,MAAM,MAAO,CAAA,SAAA,CAAU,UAAW,CAAA;AAAA,MAClD,KAAA,EAAO,EAAE,EAAG;AAAA,KACb,CAAA;AAED,IAAA,IAAI,CAAC,SAAW,EAAA;AACd,MAAA,GAAA,CAAI,OAAO,GAAG,CAAA,CAAE,KAAK,EAAE,OAAA,EAAS,uBAAuB,CAAA;AACvD,MAAA;AAAA;AAGF,IAAI,IAAA,SAAA,CAAU,YAAY,MAAQ,EAAA;AAChC,MAAA,GAAA,CAAI,OAAO,GAAG,CAAA,CAAE,KAAK,EAAE,OAAA,EAAS,2CAA2C,CAAA;AAC3E,MAAA;AAAA;AAIF,IAAA,IAAI,UAAU,KAAO,EAAA;AACnB,MAAM,MAAA,QAAA,GAAW,kBAAmB,CAAA,SAAA,CAAU,KAAK,CAAA;AACnD,MAAA,MAAM,YAAY,QAAQ,CAAA;AAAA;AAG5B,IAAM,MAAA,MAAA,CAAO,UAAU,MAAO,CAAA;AAAA,MAC5B,KAAA,EAAO,EAAE,EAAG;AAAA,KACb,CAAA;AAED,IAAA,GAAA,CAAI,OAAO,GAAG,CAAA,CAAE,KAAK,EAAE,OAAA,EAAS,kCAAkC,CAAA;AAAA,WAC3D,KAAO,EAAA;AACd,IAAQ,OAAA,CAAA,KAAA,CAAM,2BAA2B,KAAK,CAAA;AAC9C,IAAA,GAAA,CAAI,OAAO,GAAG,CAAA,CAAE,KAAK,EAAE,OAAA,EAAS,yBAAyB,CAAA;AAAA;AAE7D,CAAA;AAEO,IAAM,aAAA,GAAgB,OAAO,GAAA,EAAU,GAAiC,KAAA;AAC7E,EAAI,IAAA;AACF,IAAM,MAAA,EAAE,EAAG,EAAA,GAAI,GAAI,CAAA,MAAA;AACnB,IAAM,MAAA,MAAA,GAAS,IAAI,IAAK,CAAA,EAAA;AAExB,IAAA,MAAM,SAAY,GAAA,MAAM,MAAO,CAAA,SAAA,CAAU,UAAW,CAAA;AAAA,MAClD,KAAA,EAAO,EAAE,EAAG,EAAA;AAAA,MACZ,OAAS,EAAA;AAAA,QACP,OAAS,EAAA;AAAA;AACX,KACD,CAAA;AAED,IAAA,IAAI,CAAC,SAAW,EAAA;AACd,MAAA,GAAA,CAAI,OAAO,GAAG,CAAA,CAAE,KAAK,EAAE,OAAA,EAAS,uBAAuB,CAAA;AACvD,MAAA;AAAA;AAGF,IAAA,MAAM,qBAAqB,SAAU,CAAA,OAAA,CAAQ,KAAK,CAAK,CAAA,KAAA,CAAA,CAAE,WAAW,MAAM,CAAA;AAC1E,IAAA,IAAI,kBAAoB,EAAA;AACtB,MAAA,GAAA,CAAI,OAAO,GAAG,CAAA,CAAE,KAAK,EAAE,OAAA,EAAS,8CAA8C,CAAA;AAC9E,MAAA;AAAA;AAGF,IAAA,MAAM,UAAa,GAAA,MAAM,MAAO,CAAA,kBAAA,CAAmB,MAAO,CAAA;AAAA,MACxD,IAAM,EAAA;AAAA,QACJ,WAAa,EAAA,EAAA;AAAA,QACb,MAAA;AAAA,QACA,IAAM,EAAA;AAAA;AACR,KACD,CAAA;AAED,IAAA,GAAA,CAAI,MAAO,CAAA,GAAG,CAAE,CAAA,IAAA,CAAK,UAAU,CAAA;AAAA,WACxB,KAAO,EAAA;AACd,IAAQ,OAAA,CAAA,KAAA,CAAM,yBAAyB,KAAK,CAAA;AAC5C,IAAA,GAAA,CAAI,OAAO,GAAG,CAAA,CAAE,KAAK,EAAE,OAAA,EAAS,yBAAyB,CAAA;AAAA;AAE7D,CAAA;AAEO,IAAM,cAAA,GAAiB,OAAO,GAAA,EAAU,GAAiC,KAAA;AAC9E,EAAI,IAAA;AACF,IAAM,MAAA,EAAE,EAAG,EAAA,GAAI,GAAI,CAAA,MAAA;AACnB,IAAM,MAAA,MAAA,GAAS,IAAI,IAAK,CAAA,EAAA;AAExB,IAAA,MAAM,SAAY,GAAA,MAAM,MAAO,CAAA,SAAA,CAAU,UAAW,CAAA;AAAA,MAClD,KAAA,EAAO,EAAE,EAAG,EAAA;AAAA,MACZ,OAAS,EAAA;AAAA,QACP,OAAS,EAAA;AAAA;AACX,KACD,CAAA;AAED,IAAA,IAAI,CAAC,SAAW,EAAA;AACd,MAAA,GAAA,CAAI,OAAO,GAAG,CAAA,CAAE,KAAK,EAAE,OAAA,EAAS,uBAAuB,CAAA;AACvD,MAAA;AAAA;AAGF,IAAI,IAAA,SAAA,CAAU,YAAY,MAAQ,EAAA;AAChC,MAAA,GAAA,CAAI,OAAO,GAAG,CAAA,CAAE,KAAK,EAAE,OAAA,EAAS,oCAAoC,CAAA;AACpE,MAAA;AAAA;AAGF,IAAA,MAAM,aAAa,SAAU,CAAA,OAAA,CAAQ,KAAK,CAAK,CAAA,KAAA,CAAA,CAAE,WAAW,MAAM,CAAA;AAClE,IAAA,IAAI,CAAC,UAAY,EAAA;AACf,MAAA,GAAA,CAAI,OAAO,GAAG,CAAA,CAAE,KAAK,EAAE,OAAA,EAAS,0CAA0C,CAAA;AAC1E,MAAA;AAAA;AAGF,IAAM,MAAA,MAAA,CAAO,mBAAmB,MAAO,CAAA;AAAA,MACrC,KAAO,EAAA;AAAA,QACL,kBAAoB,EAAA;AAAA,UAClB,WAAa,EAAA,EAAA;AAAA,UACb;AAAA;AACF;AACF,KACD,CAAA;AAED,IAAA,GAAA,CAAI,OAAO,GAAG,CAAA,CAAE,KAAK,EAAE,OAAA,EAAS,+BAA+B,CAAA;AAAA,WACxD,KAAO,EAAA;AACd,IAAQ,OAAA,CAAA,KAAA,CAAM,0BAA0B,KAAK,CAAA;AAC7C,IAAA,GAAA,CAAI,OAAO,GAAG,CAAA,CAAE,KAAK,EAAE,OAAA,EAAS,yBAAyB,CAAA;AAAA;AAE7D,CAAA;AAEO,IAAM,mBAAA,GAAsB,OAAO,GAAA,EAAc,GAAiC,KAAA;AACvF,EAAI,IAAA;AACF,IAAM,MAAA,EAAE,EAAG,EAAA,GAAI,GAAI,CAAA,MAAA;AAEnB,IAAA,IAAI,GAAI,CAAA,KAAA,CAAM,IAAQ,IAAA,GAAA,CAAI,MAAM,KAAO,EAAA;AAErC,MAAA,MAAM,IAAO,GAAA,QAAA,CAAS,GAAI,CAAA,KAAA,CAAM,IAAc,CAAK,IAAA,CAAA;AACnD,MAAA,MAAM,KAAQ,GAAA,QAAA,CAAS,GAAI,CAAA,KAAA,CAAM,KAAe,CAAK,IAAA,EAAA;AACrD,MAAM,MAAA,IAAA,GAAA,CAAQ,OAAO,CAAK,IAAA,KAAA;AAE1B,MAAA,MAAM,CAAC,OAAS,EAAA,KAAK,CAAI,GAAA,MAAM,QAAQ,GAAI,CAAA;AAAA,QACzC,MAAA,CAAO,mBAAmB,QAAS,CAAA;AAAA,UACjC,KAAA,EAAO,EAAE,WAAA,EAAa,EAAG,EAAA;AAAA,UACzB,IAAA;AAAA,UACA,IAAM,EAAA,KAAA;AAAA,UACN,OAAS,EAAA;AAAA,YACP,IAAM,EAAA;AAAA,cACJ,MAAQ,EAAA;AAAA,gBACN,EAAI,EAAA,IAAA;AAAA,gBACJ,IAAM,EAAA,IAAA;AAAA,gBACN,KAAO,EAAA,IAAA;AAAA,gBACP,KAAO,EAAA;AAAA;AACT;AACF;AACF,SACD,CAAA;AAAA,QACD,MAAA,CAAO,mBAAmB,KAAM,CAAA;AAAA,UAC9B,KAAA,EAAO,EAAE,WAAA,EAAa,EAAG;AAAA,SAC1B;AAAA,OACF,CAAA;AAED,MAAI,GAAA,CAAA,MAAA,CAAO,GAAG,CAAA,CAAE,IAAK,CAAA;AAAA,QACnB,OAAA,EAAS,OAAQ,CAAA,GAAA,CAAI,CAAW,MAAA,MAAA;AAAA,UAC9B,EAAA,EAAI,OAAO,IAAK,CAAA,EAAA;AAAA,UAChB,IAAA,EAAM,OAAO,IAAK,CAAA,IAAA;AAAA,UAClB,KAAA,EAAO,OAAO,IAAK,CAAA,KAAA;AAAA,UACnB,KAAA,EAAO,OAAO,IAAK,CAAA,KAAA;AAAA,UACnB,MAAM,MAAO,CAAA;AAAA,SACb,CAAA,CAAA;AAAA,QACF,KAAA;AAAA,QACA,OAAA,EAAS,QAAQ,IAAO,GAAA;AAAA,OACzB,CAAA;AAAA,KACI,MAAA;AAEL,MAAA,MAAM,OAAU,GAAA,MAAM,MAAO,CAAA,kBAAA,CAAmB,QAAS,CAAA;AAAA,QACvD,KAAA,EAAO,EAAE,WAAA,EAAa,EAAG,EAAA;AAAA,QACzB,OAAS,EAAA;AAAA,UACP,IAAM,EAAA;AAAA,YACJ,MAAQ,EAAA;AAAA,cACN,EAAI,EAAA,IAAA;AAAA,cACJ,IAAM,EAAA,IAAA;AAAA,cACN,KAAO,EAAA,IAAA;AAAA,cACP,KAAO,EAAA;AAAA;AACT;AACF;AACF,OACD,CAAA;AAGD,MAAM,MAAA,gBAAA,GAAmB,OAAQ,CAAA,GAAA,CAAI,CAAW,MAAA,MAAA;AAAA,QAC9C,EAAA,EAAI,OAAO,IAAK,CAAA,EAAA;AAAA,QAChB,IAAA,EAAM,OAAO,IAAK,CAAA,IAAA;AAAA,QAClB,KAAA,EAAO,OAAO,IAAK,CAAA,KAAA;AAAA,QACnB,KAAA,EAAO,OAAO,IAAK,CAAA,KAAA;AAAA,QACnB,MAAM,MAAO,CAAA;AAAA,OACb,CAAA,CAAA;AAEF,MAAA,GAAA,CAAI,MAAO,CAAA,GAAG,CAAE,CAAA,IAAA,CAAK,gBAAgB,CAAA;AAAA;AACvC,WACO,KAAO,EAAA;AACd,IAAQ,OAAA,CAAA,KAAA,CAAM,gCAAgC,KAAK,CAAA;AACnD,IAAA,GAAA,CAAI,OAAO,GAAG,CAAA,CAAE,KAAK,EAAE,OAAA,EAAS,yBAAyB,CAAA;AAAA;AAE7D,CAAA;;;ACjYA,IAAMG,OAAAA,GAASJ,0BAAQ,MAAO,EAAA;AAE9BI,OAAO,CAAA,IAAA,CAAK,KAAK,UAAY,EAAA,MAAA,CAAO,UAAW,CAAA,MAAA,CAAO,OAAO,CAAA,EAAG,eAAe,CAAA;AAC/EA,OAAO,CAAA,GAAA,CAAI,KAAK,iBAAiB,CAAA;AACjCA,OAAO,CAAA,GAAA,CAAI,QAAQ,YAAY,CAAA;AAC/BA,OAAO,CAAA,GAAA,CAAI,QAAQ,UAAY,EAAA,MAAA,CAAO,UAAW,CAAA,MAAA,CAAO,OAAO,CAAA,EAAG,eAAe,CAAA;AACjFA,OAAO,CAAA,MAAA,CAAO,MAAQ,EAAA,UAAA,EAAY,eAAe,CAAA;AACjDA,OAAO,CAAA,IAAA,CAAK,WAAa,EAAA,UAAA,EAAY,aAAa,CAAA;AAClDA,OAAO,CAAA,IAAA,CAAK,YAAc,EAAA,UAAA,EAAY,cAAc,CAAA;AACpDA,OAAO,CAAA,GAAA,CAAI,gBAAgB,mBAAmB,CAAA;AAE9C,IAAO,uBAAQA,GAAAA,OAAAA;AChBfC,uBAAO,CAAA,MAAA,CAAO,EAAE,IAAA,EAAMC,qBAAK,CAAA,OAAA,CAAQ,QAAQ,GAAI,EAAA,EAAG,MAAM,CAAA,EAAG,CAAA;AAG3D,IAAM,MAAMN,yBAAQ,EAAA;AAGpB,GAAI,CAAA,GAAA,CAAIA,yBAAQ,CAAA,IAAA,EAAM,CAAA;AACtB,GAAI,CAAA,GAAA,CAAIO,+BAAc,CAAA;AACtB,GAAA,CAAI,IAAIC,qBAAK,CAAA;AAAA,EACX,QAAQ,OAAQ,CAAA,GAAA,CAAI,aAAa,aAAgB,GAAA,uBAAA,GAA0B,QAAQ,GAAI,CAAA,YAAA;AAAA,EACvF,WAAa,EAAA;AACf,CAAC,CAAC,CAAA;AAGF,GAAA,CAAI,GAAI,CAAA,GAAA,EAAK,CAAC,CAAA,EAAG,GAAQ,KAAA;AACvB,EAAA,GAAA,CAAI,KAAK,mBAAmB,CAAA;AAC9B,CAAC,CAAA;AAGD,GAAI,CAAA,GAAA,CAAI,aAAa,kBAAU,CAAA;AAC/B,GAAI,CAAA,GAAA,CAAI,oBAAoB,uBAAe,CAAA;AAG3C,GAAA,CAAI,GAAI,CAAA,CAAC,GAAY,EAAA,GAAA,EAAc,KAAe,IAAuB,KAAA;AACvE,EAAQ,OAAA,CAAA,KAAA,CAAM,iBAAiB,GAAG,CAAA;AAClC,EAAI,GAAA,CAAA,MAAA,CAAO,GAAG,CAAA,CAAE,IAAK,CAAA;AAAA,IACnB,OAAS,EAAA,uBAAA;AAAA,IACT,OAAO,OAAQ,CAAA,GAAA,CAAI,QAAa,KAAA,aAAA,GAAgB,IAAI,OAAU,GAAA;AAAA,GAC/D,CAAA;AACH,CAAC,CAAA;AAGD,GAAI,CAAA,GAAA,CAAI,CAAC,GAAA,EAAc,GAAkB,KAAA;AACvC,EAAI,GAAA,CAAA,MAAA,CAAO,GAAG,CAAA,CAAE,IAAK,CAAA,EAAE,SAAS,CAAS,MAAA,EAAA,GAAA,CAAI,GAAG,CAAA,UAAA,CAAA,EAAc,CAAA;AAChE,CAAC,CAAA;AAED,IAAO,WAAQ,GAAA,GAAA;;;ACzCfH,uBAAO,CAAA,MAAA,CAAO,EAAE,IAAA,EAAMC,qBAAK,CAAA,OAAA,CAAQ,QAAQ,GAAI,EAAA,EAAG,MAAM,CAAA,EAAG,CAAA;AAE3D,IAAI,CAAC,OAAQ,CAAA,GAAA,CAAI,UAAY,EAAA;AAC3B,EAAA,OAAA,CAAQ,MAAM,sDAAsD,CAAA;AACpE,EAAA,OAAA,CAAQ,MAAM,6BAA6B,CAAA;AAC3C,EAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAChB;AAIA,IAAM,IAAA,GAAO,OAAQ,CAAA,GAAA,CAAI,IAAQ,IAAA,GAAA;AAEjC,WAAI,CAAA,MAAA,CAAO,MAAM,MAAM;AACrB,EAAQ,OAAA,CAAA,GAAA,CAAI,CAAsC,mCAAA,EAAA,IAAI,CAAE,CAAA,CAAA;AAC1D,CAAC,CAAA;AAGD,OAAQ,CAAA,EAAA,CAAG,oBAAsB,EAAA,CAAC,MAAkB,KAAA;AAClD,EAAQ,OAAA,CAAA,KAAA,CAAM,sBAAwB,EAAA,MAAA,CAAO,OAAO,CAAA;AACtD,CAAC,CAAA","file":"index.js","sourcesContent":["import { PrismaClient } from '@prisma/client';\r\n\r\nconst prisma = new PrismaClient();\r\n\r\nexport { prisma, PrismaClient };","import jwt from \"jsonwebtoken\";\r\nimport { User } from \"@/types\";\r\nimport { Response } from \"express\";\r\n\r\n/**\r\n * Generates a JWT token and sets it as a cookie in the response\r\n * \r\n * @param userId The ID of the user to generate a token for\r\n * @param res Express response object to set the cookie on\r\n */\r\nexport const generateJwtToken = (userId: User[\"id\"], res?: Response): string => {\r\n  const token = jwt.sign({ id: userId }, process.env.JWT_SECRET!, {\r\n    expiresIn: '30d',\r\n  });\r\n\r\n  if (res) {\r\n    res.cookie('token', token, {\r\n      httpOnly: true,\r\n      secure: process.env.NODE_ENV === 'production',\r\n      sameSite: 'strict',\r\n      maxAge: 30 * 24 * 60 * 60 * 1000, // 30 days\r\n    });\r\n  }\r\n\r\n  return token;\r\n};\r\n","import { Request, Response } from \"express\";\r\nimport { prisma } from \"@/utils/prisma\";\r\nimport bcrypt from \"bcrypt\";\r\nimport { generateJwtToken } from \"@/utils/generateToken\";\r\n\r\nexport const userSignup = async (req: Request, res: Response): Promise<void> => {\r\n  const { name, email, password } = req.body;\r\n\r\n  try {\r\n    if (!name || !email || !password) {\r\n      res.status(400).json({\r\n        message: \"Please provide all fields.\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    if (password?.length < 6) {\r\n      res.status(400).json({\r\n        message: \"Password must be at least 6 characters.\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    // Check for existing user first\r\n    const existingUser = await prisma.user.findUnique({\r\n      where: { email },\r\n    });\r\n\r\n    if (existingUser) {\r\n      res.status(400).json({\r\n        message: \"User with the provided email already exist.\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    const salt = await bcrypt.genSalt(10);\r\n    const hashedPassword = await bcrypt.hash(password, salt);\r\n\r\n    const newUser = await prisma.user.create({\r\n      data: {\r\n        name,\r\n        email,\r\n        password: hashedPassword,\r\n      },\r\n      select: {\r\n        id: true,\r\n        name: true,\r\n        email: true\r\n      }\r\n    });\r\n\r\n    // Generate token first\r\n    generateJwtToken(newUser.id, res);\r\n\r\n    // Then send response\r\n    res.status(201).json(newUser);\r\n  } catch (error) {\r\n    console.error(\"Signup Error:\", error);\r\n    res.status(500).json({\r\n      message: \"Internal server error.\",\r\n    });\r\n  }\r\n};\r\n\r\nexport const userLogin = async (req: Request, res: Response): Promise<void> => {\r\n  const { email, password } = req.body;\r\n\r\n  try {\r\n    if (!email || !password) {\r\n      res.status(400).json({\r\n        message: \"Please provide all fields.\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    const user = await prisma.user.findUnique({\r\n      where: { email },\r\n      select: {\r\n        id: true,\r\n        email: true,\r\n        name: true,\r\n        password: true,\r\n      },\r\n    });\r\n\r\n    if (!user || !user.password) {\r\n      res.status(400).json({\r\n        message: \"Invalid credentials.\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    const isMatch = await bcrypt.compare(password, user.password);\r\n\r\n    if (!isMatch) {\r\n      res.status(400).json({\r\n        message: \"Invalid credentials.\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    // Generate token first\r\n    generateJwtToken(user.id, res);\r\n\r\n    // Then send response without password\r\n    res.status(200).json({\r\n      id: user.id,\r\n      name: user.name,\r\n      email: user.email,\r\n    });\r\n  } catch (error) {\r\n    console.error(\"Login Error:\", error);\r\n    res.status(500).json({\r\n      message: \"Internal server error.\",\r\n    });\r\n  }\r\n};\r\n\r\nexport const logout = async (req: Request, res: Response): Promise<void> => {\r\n  try {\r\n    res.clearCookie(\"token\");\r\n    res.status(200).json({\r\n      message: \"Logged out successfully.\",\r\n    });\r\n  } catch (error) {\r\n    console.error(\"Logout Error:\", error);\r\n    res.status(500).json({\r\n      message: \"Internal server error.\",\r\n    });\r\n  }\r\n};\r\n\r\nexport const checkAuth = async (req: any, res: Response): Promise<void> => {\r\n  try {\r\n    res.status(200).json(req.user);\r\n  } catch (error) {\r\n    console.error(\"CheckAuth Error:\", error);\r\n    res.status(500).json({\r\n      message: \"Internal server error.\",\r\n    });\r\n  }\r\n};\r\n\r\nexport const deleteUser = async (req: Request, res: Response): Promise<void> => {\r\n  const userId = req.params.id;\r\n\r\n  try {\r\n    const deletedUser = await prisma.user.delete({\r\n      where: {\r\n        id: userId,\r\n      },\r\n    });\r\n\r\n    if (!deletedUser) {\r\n      res.status(404).json({\r\n        message: \"User not found.\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    res.status(200).json({\r\n      message: \"User deleted successfully.\",\r\n    });\r\n  } catch (error) {\r\n    console.error(\"Delete User Error:\", error);\r\n    res.status(500).json({\r\n      message: \"Internal server error.\",\r\n    });\r\n  }\r\n};\r\n","import { prisma } from \"@/utils/prisma\";\r\nimport { User } from \"@/types\";\r\nimport { Request, Response, NextFunction } from \"express\";\r\nimport jwt from \"jsonwebtoken\";\r\n\r\nexport const isLoggedIn = async (\r\n  req: any,\r\n  res: Response,\r\n  next: NextFunction\r\n): Promise<any> => {\r\n  const token = req.cookies.token;\r\n\r\n  if (!token) {\r\n    return res.status(401).json({\r\n      message: \"Unauthorized\",\r\n    });\r\n  }\r\n\r\n  try {\r\n    if (!process.env.JWT_SECRET) {\r\n      throw new Error(\"JWT_SECRET is not defined\");\r\n    }\r\n\r\n    const decoded = jwt.verify(token, process.env.JWT_SECRET) as {\r\n      userId: User[\"id\"];\r\n    };\r\n\r\n    if (!decoded.userId) {\r\n      return res.status(401).json({\r\n        message: \"Unauthorized\",\r\n      });\r\n    }\r\n\r\n    const user = await prisma.user.findUnique({\r\n      where: {\r\n        id: decoded.userId,\r\n      },\r\n      select: {\r\n        id: true,\r\n        name: true,\r\n        email: true,\r\n        image: true,\r\n      },\r\n    });\r\n\r\n    if (!user) {\r\n      return res.status(401).json({\r\n        message: \"User not found.\",\r\n      });\r\n    }\r\n\r\n    req.user = user;\r\n    next();\r\n  } catch (error) {\r\n    console.error(\"Authentication Error:\", error);\r\n    return res.status(401).json({\r\n      message: \"Authentication failed. Please log in again.\",\r\n    });\r\n  }\r\n};\r\n","import express from \"express\";\r\nimport {\r\n  checkAuth,\r\n  userLogin,\r\n  userSignup,\r\n  logout,\r\n  deleteUser\r\n} from \"@/controllers/user.controller\";\r\nimport { isLoggedIn } from \"@/middleware/isUserLoggedIn\";\r\n\r\nconst router = express.Router();\r\n\r\nrouter.route(\"/signup\").post(userSignup);\r\nrouter.route(\"/login\").post(userLogin);\r\nrouter.route(\"/logout\").post(logout);\r\nrouter.route(\"/checkAuth\").post(isLoggedIn, checkAuth);\r\nrouter.route(\"/:id\").delete(isLoggedIn, deleteUser);\r\n\r\nexport default router;\r\n","import { v2 as cloudinary } from 'cloudinary';\r\nimport { CloudinaryStorage } from 'multer-storage-cloudinary';\r\nimport multer from 'multer';\r\n\r\ncloudinary.config({\r\n  cloud_name: process.env.CLOUDINARY_CLOUD_NAME,\r\n  api_key: process.env.CLOUDINARY_API_KEY,\r\n  api_secret: process.env.CLOUDINARY_API_SECRET,\r\n});\r\n\r\nconst storage = new CloudinaryStorage({\r\n  cloudinary: cloudinary,\r\n  params: {\r\n    folder: 'xenia-communities',\r\n    allowed_formats: ['jpg', 'jpeg', 'png', 'gif'],\r\n    transformation: [{ width: 500, height: 500, crop: 'limit' }],\r\n  } as any\r\n});\r\n\r\nconst uploadMiddleware = multer({ \r\n  storage: storage,\r\n  limits: {\r\n    fileSize: 5 * 1024 * 1024, // 5MB max file size\r\n  }\r\n});\r\n\r\n// Create an upload object with optional method\r\nexport const upload = {\r\n  ...uploadMiddleware,\r\n  optional: () => ({\r\n    ...uploadMiddleware,\r\n    single: (fieldName: string) => (req: any, res: any, next: any) => {\r\n      if (!req.files && !req.file) {\r\n        return next();\r\n      }\r\n      return uploadMiddleware.single(fieldName)(req, res, next);\r\n    }\r\n  })\r\n};\r\n\r\nexport const deleteImage = async (publicId: string) => {\r\n  try {\r\n    await cloudinary.uploader.destroy(publicId);\r\n  } catch (error) {\r\n    console.error('Error deleting image from Cloudinary:', error);\r\n  }\r\n};\r\n\r\nexport const getPublicIdFromUrl = (url: string) => {\r\n  const splits = url.split('/');\r\n  const filename = splits[splits.length - 1] || '';\r\n  return `xenia-communities/${filename.split('.')[0]}`;\r\n};\r\n","import { Request, Response } from \"express\";\r\nimport { prisma } from \"@/utils/prisma\";\r\nimport { deleteImage, getPublicIdFromUrl } from \"@/utils/cloudinary\";\r\n\r\nexport const createCommunity = async (req: any, res: Response): Promise<void> => {\r\n  try {\r\n    const { name, description } = req.body;\r\n    const userId = req.user.id;\r\n    \r\n    if (!name) {\r\n      res.status(400).json({ message: \"Community name is required\" });\r\n      return;\r\n    }\r\n\r\n    if (name.length > 100) {\r\n      res.status(400).json({ message: \"Community name must be less than 100 characters\" });\r\n      return;\r\n    }\r\n\r\n    // Check for existing community with same name\r\n    const existingCommunity = await prisma.community.findFirst({\r\n      where: { name }\r\n    });\r\n\r\n    if (existingCommunity) {\r\n      res.status(400).json({ message: \"Community name already exists\" });\r\n      return;\r\n    }\r\n\r\n    const community = await prisma.community.create({\r\n      data: {\r\n        name,\r\n        description,\r\n        ...(req.file?.path && { image: req.file.path }),\r\n        ownerId: userId,\r\n        members: {\r\n          create: {\r\n            userId,\r\n            role: \"OWNER\"\r\n          }\r\n        }\r\n      }\r\n    });\r\n\r\n    res.status(201).json(community);\r\n  } catch (error) {\r\n    console.error(\"Create Community Error:\", error);\r\n    res.status(500).json({ message: \"Internal server error\" });\r\n  }\r\n};\r\n\r\nexport const getCommunity = async (req: Request, res: Response): Promise<void> => {\r\n  try {\r\n    const { id } = req.params;\r\n\r\n    const community = await prisma.community.findUnique({\r\n      where: { id },\r\n      include: {\r\n        owner: {\r\n          select: {\r\n            id: true,\r\n            name: true,\r\n            email: true,\r\n            image: true\r\n          }\r\n        }\r\n      }\r\n    });\r\n\r\n    if (!community) {\r\n      res.status(404).json({ message: \"Community not found\" });\r\n      return;\r\n    }\r\n\r\n    res.status(200).json(community);\r\n  } catch (error) {\r\n    console.error(\"Get Community Error:\", error);\r\n    res.status(500).json({ message: \"Internal server error\" });\r\n  }\r\n};\r\n\r\nexport const getAllCommunities = async (req: Request, res: Response): Promise<void> => {\r\n  try {\r\n    const page = parseInt(req.query.page as string) || 1;\r\n    const limit = parseInt(req.query.limit as string) || 10;\r\n    const search = req.query.search as string;\r\n    const skip = (page - 1) * limit;\r\n\r\n    const where = search ? {\r\n      name: {\r\n        contains: search,\r\n        mode: 'insensitive' as const\r\n      }\r\n    } : {};\r\n\r\n    if (req.query.page || req.query.limit || req.query.search) {\r\n      // Return paginated response when query params are present\r\n      const [communities, total] = await Promise.all([\r\n        prisma.community.findMany({\r\n          where,\r\n          skip,\r\n          take: limit,\r\n          include: {\r\n            owner: {\r\n              select: {\r\n                id: true,\r\n                name: true,\r\n                image: true\r\n              }\r\n            },\r\n            _count: {\r\n              select: {\r\n                members: true\r\n              }\r\n            }\r\n          }\r\n        }),\r\n        prisma.community.count({ where })\r\n      ]);\r\n\r\n      res.status(200).json({\r\n        communities,\r\n        total,\r\n        hasMore: total > skip + limit\r\n      });\r\n    } else {\r\n      // Return all communities when no query params are present\r\n      const communities = await prisma.community.findMany({\r\n        include: {\r\n          owner: {\r\n            select: {\r\n              id: true,\r\n              name: true,\r\n              image: true\r\n            }\r\n          },\r\n          _count: {\r\n            select: {\r\n              members: true\r\n            }\r\n          }\r\n        }\r\n      });\r\n\r\n      res.status(200).json(communities);\r\n    }\r\n  } catch (error) {\r\n    console.error(\"Get All Communities Error:\", error);\r\n    res.status(500).json({ message: \"Internal server error\" });\r\n  }\r\n};\r\n\r\nexport const updateCommunity = async (req: any, res: Response): Promise<void> => {\r\n  try {\r\n    const { id } = req.params;\r\n    const { name, description } = req.body;\r\n    const userId = req.user.id;\r\n\r\n    const community = await prisma.community.findUnique({\r\n      where: { id }\r\n    });\r\n\r\n    if (!community) {\r\n      res.status(404).json({ message: \"Community not found\" });\r\n      return;\r\n    }\r\n\r\n    if (community.ownerId !== userId) {\r\n      res.status(403).json({ message: \"Not authorized to update this community\" });\r\n      return;\r\n    }\r\n\r\n    if (name) {\r\n      const existingCommunity = await prisma.community.findFirst({\r\n        where: {\r\n          name,\r\n          id: { not: id }\r\n        }\r\n      });\r\n\r\n      if (existingCommunity) {\r\n        res.status(400).json({ message: \"Community name already exists\" });\r\n        return;\r\n      }\r\n    }\r\n\r\n    // Only handle image deletion if a new image is being uploaded\r\n    if (req.file?.path && community.image) {\r\n      const publicId = getPublicIdFromUrl(community.image);\r\n      await deleteImage(publicId);\r\n    }\r\n\r\n    const updatedCommunity = await prisma.community.update({\r\n      where: { id },\r\n      data: {\r\n        name,\r\n        description,\r\n        ...(req.file?.path && { image: req.file.path })\r\n      }\r\n    });\r\n\r\n    res.status(200).json(updatedCommunity);\r\n  } catch (error) {\r\n    console.error(\"Update Community Error:\", error);\r\n    res.status(500).json({ message: \"Internal server error\" });\r\n  }\r\n};\r\n\r\nexport const deleteCommunity = async (req: any, res: Response): Promise<void> => {\r\n  try {\r\n    const { id } = req.params;\r\n    const userId = req.user.id;\r\n\r\n    const community = await prisma.community.findUnique({\r\n      where: { id }\r\n    });\r\n\r\n    if (!community) {\r\n      res.status(404).json({ message: \"Community not found\" });\r\n      return;\r\n    }\r\n\r\n    if (community.ownerId !== userId) {\r\n      res.status(403).json({ message: \"Not authorized to delete this community\" });\r\n      return;\r\n    }\r\n\r\n    // Delete community image from Cloudinary\r\n    if (community.image) {\r\n      const publicId = getPublicIdFromUrl(community.image);\r\n      await deleteImage(publicId);\r\n    }\r\n\r\n    await prisma.community.delete({\r\n      where: { id }\r\n    });\r\n\r\n    res.status(200).json({ message: \"Community deleted successfully\" });\r\n  } catch (error) {\r\n    console.error(\"Delete Community Error:\", error);\r\n    res.status(500).json({ message: \"Internal server error\" });\r\n  }\r\n};\r\n\r\nexport const joinCommunity = async (req: any, res: Response): Promise<void> => {\r\n  try {\r\n    const { id } = req.params;\r\n    const userId = req.user.id;\r\n\r\n    const community = await prisma.community.findUnique({\r\n      where: { id },\r\n      include: {\r\n        members: true\r\n      }\r\n    });\r\n\r\n    if (!community) {\r\n      res.status(404).json({ message: \"Community not found\" });\r\n      return;\r\n    }\r\n\r\n    const existingMembership = community.members.find(m => m.userId === userId);\r\n    if (existingMembership) {\r\n      res.status(400).json({ message: \"User is already a member of this community\" });\r\n      return;\r\n    }\r\n\r\n    const membership = await prisma.communitiesOnUsers.create({\r\n      data: {\r\n        communityId: id,\r\n        userId,\r\n        role: \"MEMBER\"\r\n      }\r\n    });\r\n\r\n    res.status(200).json(membership);\r\n  } catch (error) {\r\n    console.error(\"Join Community Error:\", error);\r\n    res.status(500).json({ message: \"Internal server error\" });\r\n  }\r\n};\r\n\r\nexport const leaveCommunity = async (req: any, res: Response): Promise<void> => {\r\n  try {\r\n    const { id } = req.params;\r\n    const userId = req.user.id;\r\n\r\n    const community = await prisma.community.findUnique({\r\n      where: { id },\r\n      include: {\r\n        members: true\r\n      }\r\n    });\r\n\r\n    if (!community) {\r\n      res.status(404).json({ message: \"Community not found\" });\r\n      return;\r\n    }\r\n\r\n    if (community.ownerId === userId) {\r\n      res.status(400).json({ message: \"Owner cannot leave the community\" });\r\n      return;\r\n    }\r\n\r\n    const membership = community.members.find(m => m.userId === userId);\r\n    if (!membership) {\r\n      res.status(400).json({ message: \"User is not a member of this community\" });\r\n      return;\r\n    }\r\n\r\n    await prisma.communitiesOnUsers.delete({\r\n      where: {\r\n        communityId_userId: {\r\n          communityId: id,\r\n          userId\r\n        }\r\n      }\r\n    });\r\n\r\n    res.status(200).json({ message: \"Left community successfully\" });\r\n  } catch (error) {\r\n    console.error(\"Leave Community Error:\", error);\r\n    res.status(500).json({ message: \"Internal server error\" });\r\n  }\r\n};\r\n\r\nexport const getCommunityMembers = async (req: Request, res: Response): Promise<void> => {\r\n  try {\r\n    const { id } = req.params;\r\n    \r\n    if (req.query.page || req.query.limit) {\r\n      // Paginated response when page/limit is specified\r\n      const page = parseInt(req.query.page as string) || 1;\r\n      const limit = parseInt(req.query.limit as string) || 10;\r\n      const skip = (page - 1) * limit;\r\n\r\n      const [members, total] = await Promise.all([\r\n        prisma.communitiesOnUsers.findMany({\r\n          where: { communityId: id },\r\n          skip,\r\n          take: limit,\r\n          include: {\r\n            user: {\r\n              select: {\r\n                id: true,\r\n                name: true,\r\n                email: true,\r\n                image: true\r\n              }\r\n            }\r\n          }\r\n        }),\r\n        prisma.communitiesOnUsers.count({\r\n          where: { communityId: id }\r\n        })\r\n      ]);\r\n\r\n      res.status(200).json({\r\n        members: members.map(member => ({\r\n          id: member.user.id,\r\n          name: member.user.name,\r\n          email: member.user.email,\r\n          image: member.user.image,\r\n          role: member.role\r\n        })),\r\n        total,\r\n        hasMore: total > skip + limit\r\n      });\r\n    } else {\r\n      // Simple array response for non-paginated requests (what the test expects)\r\n      const members = await prisma.communitiesOnUsers.findMany({\r\n        where: { communityId: id },\r\n        include: {\r\n          user: {\r\n            select: {\r\n              id: true,\r\n              name: true,\r\n              email: true,\r\n              image: true\r\n            }\r\n          }\r\n        }\r\n      });\r\n\r\n      // Format the response as a flat array of user objects with roles\r\n      const formattedMembers = members.map(member => ({\r\n        id: member.user.id,\r\n        name: member.user.name,\r\n        email: member.user.email,\r\n        image: member.user.image,\r\n        role: member.role\r\n      }));\r\n\r\n      res.status(200).json(formattedMembers);\r\n    }\r\n  } catch (error) {\r\n    console.error(\"Get Community Members Error:\", error);\r\n    res.status(500).json({ message: \"Internal server error\" });\r\n  }\r\n};\r\n","import express from \"express\";\r\nimport { upload } from \"@/utils/cloudinary\";\r\nimport {\r\n  createCommunity,\r\n  getCommunity,\r\n  getAllCommunities,\r\n  updateCommunity,\r\n  deleteCommunity,\r\n  joinCommunity,\r\n  leaveCommunity,\r\n  getCommunityMembers\r\n} from \"@/controllers/community.controller\";\r\nimport { isLoggedIn } from \"@/middleware/isUserLoggedIn\";\r\n\r\nconst router = express.Router();\r\n\r\nrouter.post(\"/\", isLoggedIn, upload.optional().single('image'), createCommunity);\r\nrouter.get(\"/\", getAllCommunities);\r\nrouter.get(\"/:id\", getCommunity);\r\nrouter.put(\"/:id\", isLoggedIn, upload.optional().single('image'), updateCommunity);\r\nrouter.delete(\"/:id\", isLoggedIn, deleteCommunity);\r\nrouter.post(\"/:id/join\", isLoggedIn, joinCommunity);\r\nrouter.post(\"/:id/leave\", isLoggedIn, leaveCommunity);\r\nrouter.get(\"/:id/members\", getCommunityMembers);\r\n\r\nexport default router;\r\n","import express, { Request, Response, NextFunction } from \"express\";\r\nimport cookieParser from \"cookie-parser\";\r\nimport cors from \"cors\";\r\nimport userRouter from \"@/routes/user.route\";\r\nimport communityRouter from \"@/routes/community.route\";\r\nimport path from \"path\";\r\nimport dotenv from \"dotenv\";\r\n\r\n// Configure dotenv to load .env file\r\ndotenv.config({ path: path.resolve(process.cwd(), \".env\") });\r\n\r\n// Create Express app\r\nconst app = express();\r\n\r\n// Middleware\r\napp.use(express.json());\r\napp.use(cookieParser());\r\napp.use(cors({\r\n  origin: process.env.NODE_ENV === 'development' ? 'http://localhost:3000' : process.env.FRONTEND_URL,\r\n  credentials: true\r\n}));\r\n\r\n// Health check route\r\napp.get(\"/\", (_, res) => {\r\n  res.send(\"API is running...\");\r\n});\r\n\r\n// Routes\r\napp.use(\"/api/user\", userRouter);\r\napp.use(\"/api/communities\", communityRouter);\r\n\r\n// Error handler middleware\r\napp.use((err: Error, req: Request, res: Response, next: NextFunction) => {\r\n  console.error('Server Error:', err);\r\n  res.status(500).json({\r\n    message: \"Internal server error\",\r\n    error: process.env.NODE_ENV === 'development' ? err.message : undefined\r\n  });\r\n});\r\n\r\n// Handle 404 errors\r\napp.use((req: Request, res: Response) => {\r\n  res.status(404).json({ message: `Route ${req.url} not found` });\r\n});\r\n\r\nexport default app;\r\n","import dotenv from \"dotenv\";\r\nimport path from \"path\";\r\n\r\n// Configure dotenv to load .env file\r\ndotenv.config({ path: path.resolve(process.cwd(), \".env\") });\r\n\r\nif (!process.env.JWT_SECRET) {\r\n  console.error(\"Critical environment variable JWT_SECRET is missing!\");\r\n  console.error(\"Please check your .env file\");\r\n  process.exit(1);\r\n}\r\n\r\nimport app from \"./app\";\r\n\r\nconst port = process.env.PORT || 8000;\r\n\r\napp.listen(port, () => {\r\n  console.log(`Server running at http://localhost:${port}`);\r\n});\r\n\r\n// Handle unhandled promise rejections\r\nprocess.on('unhandledRejection', (reason: Error) => {\r\n  console.error('Unhandled Rejection:', reason.message);\r\n});\r\n"]}